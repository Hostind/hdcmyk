<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Status Bar Test</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            height: 200vh; /* Make page scrollable */
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
        }
        
        .content {
            padding: 20px;
            color: white;
        }
        
        .test-section {
            margin: 50px 0;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
        }
    </style>
    <link rel="stylesheet" href="src/css/styles.css">
</head>
<body>
    <!-- Enhanced Sticky Status Bar -->
    <div class="status-bar" id="status-bar">
        <div class="status-bar-content">
            <div class="status-info">
                <span class="status-label">Status:</span>
                <span class="status-value" id="status-value">Ready</span>
            </div>
            <div class="delta-info">
                <span class="delta-label">Î”E*ab:</span>
                <span class="delta-value" id="status-delta-value">--</span>
            </div>
            <div class="quick-actions-bar">
                <button class="status-action-btn" id="status-calculate-btn" title="Calculate color difference">
                    Calculate
                </button>
                <button class="status-action-btn" id="status-reset-btn" title="Reset all inputs">
                    Reset
                </button>
                <button class="status-action-btn" id="status-export-btn" title="Export results" disabled>
                    Export
                </button>
            </div>
        </div>
    </div>

    <div class="content">
        <h1>Status Bar Test Page</h1>
        <div class="test-section">
            <h2>Scroll Test</h2>
            <p>Scroll down to see the sticky status bar appear after 100px of scrolling.</p>
            <button onclick="testStatusUpdates()">Test Status Updates</button>
        </div>
        
        <div class="test-section">
            <h2>Status Bar Features</h2>
            <ul>
                <li>Appears when scrolling down past 100px</li>
                <li>Shows current calculation status</li>
                <li>Displays Delta E value when available</li>
                <li>Provides quick action buttons</li>
                <li>Responsive design for mobile devices</li>
            </ul>
        </div>
        
        <div class="test-section">
            <h2>More Content</h2>
            <p>This is additional content to make the page scrollable and test the sticky behavior.</p>
        </div>
        
        <div class="test-section">
            <h2>Final Section</h2>
            <p>Keep scrolling to test the status bar visibility.</p>
        </div>
    </div>

    <script>
        // Simplified version of the status bar functionality for testing
        const scrollState = {
            lastScrollY: 0,
            scrollDirection: 'down',
            statusBarThreshold: 100,
            isStatusBarVisible: false
        };

        function setupScrollDetection() {
            let ticking = false;
            
            function updateScrollState() {
                const currentScrollY = window.scrollY;
                const shouldShowStatusBar = currentScrollY > scrollState.statusBarThreshold;
                
                if (shouldShowStatusBar !== scrollState.isStatusBarVisible) {
                    scrollState.isStatusBarVisible = shouldShowStatusBar;
                    toggleStatusBarVisibility(shouldShowStatusBar);
                }
                
                ticking = false;
            }
            
            function requestScrollUpdate() {
                if (!ticking) {
                    requestAnimationFrame(updateScrollState);
                    ticking = true;
                }
            }
            
            window.addEventListener('scroll', requestScrollUpdate, { passive: true });
            updateScrollState();
        }

        function toggleStatusBarVisibility(show) {
            const statusBar = document.getElementById('status-bar');
            if (!statusBar) return;
            
            if (show) {
                statusBar.classList.add('visible');
            } else {
                statusBar.classList.remove('visible');
            }
        }

        function testStatusUpdates() {
            const statusValue = document.getElementById('status-value');
            const deltaValue = document.getElementById('status-delta-value');
            const exportBtn = document.getElementById('status-export-btn');
            
            // Test calculating state
            statusValue.textContent = 'Calculating...';
            statusValue.className = 'status-value calculating';
            
            setTimeout(() => {
                // Test complete state with Delta E value
                statusValue.textContent = 'Complete';
                statusValue.className = 'status-value complete';
                deltaValue.textContent = '2.45';
                deltaValue.className = 'delta-value acceptable';
                exportBtn.disabled = false;
            }, 2000);
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            setupScrollDetection();
            
            // Add event listeners to buttons
            document.getElementById('status-calculate-btn').addEventListener('click', function() {
                alert('Calculate button clicked!');
            });
            
            document.getElementById('status-reset-btn').addEventListener('click', function() {
                alert('Reset button clicked!');
                // Reset status
                const statusValue = document.getElementById('status-value');
                const deltaValue = document.getElementById('status-delta-value');
                const exportBtn = document.getElementById('status-export-btn');
                
                statusValue.textContent = 'Ready';
                statusValue.className = 'status-value';
                deltaValue.textContent = '--';
                deltaValue.className = 'delta-value';
                exportBtn.disabled = true;
            });
            
            document.getElementById('status-export-btn').addEventListener('click', function() {
                if (!this.disabled) {
                    alert('Export button clicked!');
                }
            });
        });
    </script>
</body>
</html>